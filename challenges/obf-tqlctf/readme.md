# TriVM-obf

This challenge was used in TQLCTF2022.

运行 [com.py](com.py) 可生成 `a3.S`，再调用汇编器可以生成三进制文件。

本题算是 THUCTF2021 中的 [obf](../obf-thuctf) 的加强版。该题中的部分加和乘操作是在 $\bmod 3^{16}-2$ 下运算的，本题改为了直接 $\bmod 3^{18}$ 运算，消除了这些取模的特征。同时，本题的编译器经过修改，会在中间代码阶段对指令进行一定的 shuffle，增大逆向难度。

## 可能的解法

先提取出数据流，然后对输入采用控制变量法，分析有哪些数据改变，哪些不变，再结合 MBA-Blast 中的方法，得出实际的表达式，以此类推，逐层求解。而要在混淆后的数据流中找到每一层，可以考虑对整个数据流图使用最小割等算法，找出关键变量，此方法虽然会找到一部分 MBA 中增加的混淆变量，但对于本题应该影响不大，足以得到较为简单的表达式。