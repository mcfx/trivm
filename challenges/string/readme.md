# TriVM-string

This challenge was used in TQLCTF2022.

## Write Up

本题实现了一个 AC 自动机，然后会给每个节点单独分配一段内存，前面几个位置是跳转用的代码，后面是转移边的跳转表（其实是想实现一个类似 jit 的操作，虽然实际上这对 AC 自动机来说并不会变快吧）。主要漏洞是可以用转移边覆盖前面的代码，进而跳转到我们传入的 shellcode 中。

原计划选手需要构造一定长度的总输入串长，以让转移边是合适的指令，但是似乎因为题目中有一堆其他漏洞被绕过了。另外本应需要选手构造满足一定条件的 shellcode（没有 0），但是好像也被绕过了（不排除是编译器写挂了）。

代码见 [exp.py](exp.py)。

